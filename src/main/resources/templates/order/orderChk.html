<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>ESSENTIAL#</title>
<link rel="stylesheet" href="/css/aboutUs.css">
<link rel="stylesheet" href="/css/cart.css">
<link rel="stylesheet" href="/css/event.css">
<script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
</head>
<body>
	<th:block th:include="common/header"></th:block>
	<div class="us-wrap">
		<div class="us-title">
			<br>
			<h1>주문하기</h1>
		</div>
			
	<th:block th:if="${list.size != 0 && session.m!=null}">

	<div class="full-cart cart-no-bottom">
		<table class="order-tbl">
			<tr colspan="3">
				<th>주문자 정보</th>
			</tr>
			<tr>
				<th><span>보내는 분 </span></th>
				<td colspan="2"><span th:text="${session.m.memberName}"></span></td>
			</tr>
			<tr>
				<th><span>연락처</span></th>
				<td colspan="2"><span th:text="${session.m.memberPhone}"></span></td>
			</tr>
			<tr>
				<th><span>이메일</span></th>
				<td colspan="2"><span th:text="${session.m.memberEmail}"></span></td>
			</tr>
			<tr>
				<th><span>배송지</span></th>
				<td><span th:text="${session.m.memberAddr}" id="memberAddr"></span><span> </span>
				<input type="text" th:val="${session.m.detail}" id="detail" placeholder="상세 주소를 입력하세요."></td>
				<td class="addr-td"><button type="button" class="addr-btn" onclick="searchAddress();">배송지 변경</button></td>
			</tr>
		</table>
		<!-- db에 포인트가 없어서 일단 보류
		<table class="order-tbl">
			<tr colspan="2">
				<th>적립금</th>
			</tr>
			<tr>
				<th><span>적립금 사용 </span></th>
				<td><input type="text" th:placeholder="${session.m.point}"></td>
			</tr>
		</table>		
		 -->
	</div>

	<div class="full-cart">
		<table class="tbl notice-tbl">
			<tbody>
			<tr>
				<th style="width: 10%;"><input type="checkbox" id="cartAll"></th>
				<th style="width: 40%;">상품정보</th>
				<th style="width: 20%;">수량</th>
				<th style="width: 15%;">적립금</th>
				<th style="width: 15%;">가격</th>
			</tr>
			<tr th:each = "cart : ${list}">
				<td>
					<input type="checkbox" class="cartChk" name="cartNo" value="${cart.cartNo}">
				</td>
				<td style="text-align:left; padding-left:20px;">
					<a th:href="@{/product/productDetail(productNo=${cart.productNo})}" class="cart-detail">
					<span th:text="${cart.productName}"></span>
					<span th:if="${cart.optionName} !=null">(옵션 : <span th:text="${cart.optionName}"></span>)</span>
					</a>
					</td>
				<td class="option-count">
					<span th:text="${cart.count}"></span>
				</td>
				<td>
					<span th:text="${#numbers.formatInteger(cart.productPoint, 3, 'COMMA')}"></span>
				</td>
				<td>
					<s th:text="${cart.getPpc}+원"></s>
					<p th:text="${cart.getPfpc}+원"></p>
				</td>
			</tr>
			<tr style="border-top:1px solid #333;">
				<td colspan="3">
				<p class="guide-ment">ESSENTIAL#은 전 상품 무료배송입니다.</p>
				</td>
				<td colspan="2" class="cart-total" style="text-align:right; padding-right:25px; font-weight:bold; color:#A52502;">
					총 가격 <span th:text="${#numbers.formatInteger(#aggregates.sum(list.![productFinalPrice*count]), 3, 'COMMA') + '원'}" style="color:#A52502;"></span>
				</td>
			</tr>
				</tbody>
			</table>
		</div>
		
	<div class="full-cart cart-no-bottom">
		<table class="order-tbl">
			<tr colspan="3">
				<th>결제 금액</th>
			</tr>
			<tr>
				<th><span>상품 금액 </span></th>
				<td colspan="2"><span th:text="${#numbers.formatInteger(#aggregates.sum(list.![productFinalPrice*count]), 3, 'COMMA') + '원'}"></span></td>
			</tr>
			<tr>
				<th><span>상품 할인</span></th>
				<td colspan="2"><span th:text="${#numbers.formatInteger(#aggregates.sum(list.![(productFinalPrice-productPrice)*count]), 3, 'COMMA') + '원'}" style="color:#1C8394;"></span></td>
			</tr>
			<!-- <tr>
				<th><span>적립금 사용</span></th>적립금 있으면 최종 금액 추가해야 함
				<td colspan="2"><span th:text="${session.m.memberEmail}"></span></td>
			</tr>
			 -->
			<tr>
				<th><span>배송비</span></th>
				<td><span style="color:#1C8394;">무료 배송</span></td>
			</tr>
		</table>
	</div>
		<div class="full-cart cart-no-bottom">
		<table class="order-tbl">
			<tr colspan="3">
				<th>결제 정보</th>
			</tr>
			<tr>
				<th><span>결제 안내 </span></th>
				<td colspan="2"><span th:text="${#numbers.formatInteger(#aggregates.sum(list.![productFinalPrice*count]), 3, 'COMMA') + '원'}"></span></td>
			</tr>
			<tr>
				<th><span>품절 시 환불 안내</span></th>
				<td colspan="2">
					<p>결제하신 수단으로 취소됩니다.</p>
				</td>
			</tr>
		</table>
	</div>
	</th:block>
</div>
		<th:block th:include="common/footer"></th:block>



	<script src="/javascript/orderPage.js"></script>
	<script src="/javascript/modal.js"></script>
</body>
</html>